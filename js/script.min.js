"use strict";const LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)";function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function debounce(e,t=500){let o;return(...s)=>{clearTimeout(o),o=setTimeout((()=>e.apply(this,s)),t)}}function togglePageScroll(){const e=document.body.clientWidth;if(document.body.classList.toggle("scroll-lock"),document.body.classList.contains("scroll-lock")){if(document.body.clientWidth===e)return;document.body.style.paddingRight=document.body.clientWidth-e+"px"}else document.body.style.paddingRight="0"}function lockPageScroll(){const e=document.body.clientWidth;document.body.classList.add("scroll-lock"),document.body.clientWidth!==e&&(document.body.style.paddingRight=document.body.clientWidth-e+"px")}function initAdaptiveTable(e){e.addEventListener("click",(({target:e})=>{const t=e.closest(".adaptive-table__row");t?.classList.toggle("adaptive-table__row--open")}))}function initAlertCreator(e){return t=>{const o=createElementByString(`\n      <dialog class="modal modal--position_center modal--with_alert">\n        <div class="modal__inner">\n          <button class="modal__close-button" type="button">\n            <span class="visually-hidden">Закрыть</span>\n          </button>\n          <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n            <h2 class="alert__heading heading">${t.heading}</h2>\n            ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n            <button class="alert__button button button--primary" type="button">${t.buttonText||"Закрыть"}</button>\n          </section>\n        </div>\n      </dialog>\n    `);document.body.append(o),e(o)}}async function sendData(e,t,o=(()=>{}),s=(()=>{}),i=(()=>{})){try{const s=await fetch(e,{method:"POST",body:t});if(!s.ok)throw new Error(`${s.status} – ${s.statusText}`);o(await s.json())}catch(e){s()}finally{i()}}function initBurger(e,t){const o="burger--open";e.addEventListener("click",(s=>{s.preventDefault(),e.classList.toggle(o),e.ariaExpanded=e.classList.contains(o),t()}))}function initCertificatesList(e){const t=e.querySelector(".certificates-list__item"),o=e.querySelector(".certificates-list__button"),s=()=>{e.classList.remove("certificates-list--short"),setTimeout((()=>{e.offsetHeight>t.offsetHeight&&e.classList.add("certificates-list--short")}),0)};s(),window.addEventListener("resize",debounce(s)),o.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("certificates-list--short")}))}function initFeaturesList(e){const t=Array.from(e.querySelectorAll(".features-list__item")),o=()=>{e.style.setProperty("--item-min-height",0),setTimeout((()=>{const o=t.map((e=>e.offsetHeight)),s=`${Math.max(...o)}px`;e.style.setProperty("--item-min-height",s)}),0)};o(),window.addEventListener("resize",debounce(o))}function initFeaturesSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1260:{slidesPerView:3},1580:{slidesPerView:3,spaceBetween:20}}})}const initFolds=e=>{e.addEventListener("click",(({target:e})=>{const t=e.closest(".folds__button");if(!t)return;t.closest(".folds__item").classList.toggle("folds__item--open"),t.ariaExpanded="true"===t.ariaExpanded?"false":"true"}))},formAlerts={request:{success:{heading:"Заявка отправлена",text:"Скоро с Вами свяжется наш менеджер для уточнения деталей заказа и доставки"},error:{status:"error",heading:"Ошибка",text:"Ошибки – это доказательство того, что ты пытаешься."}}};function initForm({formElement:e,sendData:t,showAlert:o}){const s="button--pending",i=e.dataset.name,r=e.querySelector(".form__submit-button"),n=e.querySelector(".form__error-message-wrapper"),a=e.getAttribute("action"),l=e.querySelector(".form__item--name .text-field__control"),d=e.querySelector(".form__item--phone .text-field__control"),c=e.querySelector(".form__item--organization .text-field__control"),u=e.querySelector(".form__item--message .text-area__control");l&&(l.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),d&&(d.dataset.pristineRequiredMessage="Заполните это поле."),c&&(c.dataset.pristineRequiredMessage="Заполните это поле."),u&&(u.dataset.pristineRequiredMessage="Заполните это поле.");const m=new Pristine(e,{classTo:"form__item",errorClass:"invalid",errorTextParent:"form__item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("submit",(l=>{l.preventDefault();m.validate()?(n.innerHTML="",r.disabled=!0,r.classList.add(s),t(a,new FormData(l.target),(t=>{o(formAlerts[i].success),e.reset()}),(()=>{n.insertAdjacentHTML("beforeend","<strong class='form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{n.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{r.disabled=!1,r.classList.remove(s)}))):(e.classList.remove("shake"),setTimeout((()=>e.classList.add("shake")),50))}))}async function initMap(e){const t=[43.895817,56.227675],o=e.querySelector(".map__inner");await ymaps3.ready;const{YMap:s,YMapDefaultSchemeLayer:i,YMapMarker:r,YMapDefaultFeaturesLayer:n}=ymaps3,a=new s(o,{location:{center:t,zoom:12}});a.addChild(new i),a.addChild(new n);const l=new r({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0));a.addChild(l)}function initModalForm({modalElement:e,openModal:t,sendData:o}){const s="button--pending",i=e.dataset.modal,r=e.querySelector(".modal__inner"),n=r.querySelector(".modal-form-section"),a=n.querySelector(".modal-form"),l=a.querySelector(".modal-form__submit-button"),d=a.querySelector(".modal-form__error-message-wrapper"),c=a.getAttribute("action"),u=a.querySelector(".modal-form__item--name .text-field__control"),m=a.querySelector(".modal-form__item--phone .text-field__control"),p=a.querySelector(".modal-form__item--organization .text-field__control"),_=a.querySelector(".modal-form__item--message .text-area__control");u&&(u.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",u.dataset.pristineRequiredMessage="Заполните это поле.",u.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле."),p&&(p.dataset.pristineRequiredMessage="Заполните это поле."),_&&(_.dataset.pristineRequiredMessage="Заполните это поле.");const f=new Pristine(a,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});a.addEventListener("submit",(e=>{e.preventDefault();f.validate()?(d.innerHTML="",l.disabled=!0,l.classList.add(s),o(c,new FormData(e.target),(e=>{n.classList.add("modal-form-section--response"),a.reset()}),(()=>{d.insertAdjacentHTML("beforeend","<strong class='modal-form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{d.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{l.disabled=!1,l.classList.remove(s)}))):(a.classList.remove("shake"),setTimeout((()=>a.classList.add("shake")),50))})),document.querySelectorAll(`[data-modal-opener="${i}"]`).forEach((o=>{const s=o.closest(".options");if(s){const e=Array.from(s.querySelectorAll(".options__variants-link--active")).map((e=>`\n        <input type="hidden" name=${e.dataset.name} value=${e.dataset.value}>\n      `)).join("");a.insertAdjacentHTML("beforeend",e)}o.addEventListener("click",(o=>{o.preventDefault(),d.innerHTML="",f.reset(),a.reset(),a.classList.remove("shake"),r.addEventListener("transitionend",(()=>{e.querySelector("input").focus()}),{once:!0}),n.classList.remove("modal-form-section--response"),t(e)}))}))}const openedModals=[];function openModal(e){togglePageScroll(),e.showModal(),openedModals.push(e),document.addEventListener("click",onModalClick),e.addEventListener("close",onModalClose)}function closeModal(e){e.close(),setTimeout((()=>{e.removeEventListener("close",onModalClose)}),0)}function onModalClose(e){const t=openedModals.pop();if(t.classList.contains("modal--with_alert")&&t.addEventListener("transitionend",(e=>{"transform"===e.propertyName&&t.remove()}),{once:!0}),!openedModals.length){e.target.querySelector(".modal__inner").addEventListener("transitionend",(({target:e})=>{(e.classList.contains("modal")||e.classList.contains("modal__inner"))&&togglePageScroll()}),{once:!0}),document.removeEventListener("click",onModalClick)}}function onModalClick({target:e}){(e.classList.contains("modal__close-button")||e.classList.contains("alert__button"))&&closeModal(openedModals.at(-1))}function initNewsSelectionList(e){const t=document.querySelector(".cursor-picture"),o=t.querySelector(".cursor-picture__image");e.querySelectorAll(".selection-list__item-link").forEach((e=>{e.addEventListener("mouseover",(({target:e})=>{const s=e.parentElement.dataset.cursorImage;o.style.backgroundImage=`url("${s}")`,t.classList.remove("cursor-picture--hidden")})),e.addEventListener("mousemove",(e=>{t.style.top=`${e.pageY}px`,t.style.left=`${e.pageX}px`})),e.addEventListener("mouseout",(()=>{t.classList.add("cursor-picture--hidden")}))}))}function initPhotoSlider(e){const t=e.querySelector(".photo-slider__main-slider"),o=t.querySelector(".photo-slider__main-slider-arrow--prev"),s=t.querySelector(".photo-slider__main-slider-arrow--next"),i=e.querySelector(".photo-slider__thumbnails-slider"),r=new Swiper(i,{spaceBetween:10,watchSlidesProgress:!0,slidesPerView:3,spaceBetween:10,breakpoints:{1580:{spaceBetween:20}}});new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},navigation:{prevEl:o,nextEl:s,disabledClass:"photo-slider__main-slider-arrow--disabled"},thumbs:{swiper:r,slideThumbActiveClass:"photo-slider__thumbnails-slider-item--active"}})}function initProductionSlider(e){const t=e.querySelector(".production-slider__slider"),o=new Swiper(t,{slidesPerView:1,pagination:{el:".production-slider__pagination",bulletClass:"production-slider__pagination-item",bulletActiveClass:"production-slider__pagination-item--active"},allowTouchMove:!1});let s="null";o.on("slideChange",(()=>{e.classList.remove(s);const t=o.realIndex+1;switch(!0){case t%4==3:s="production-slider--theme_3";break;case t%2==0:s="production-slider--theme_2";break;default:s="production-slider--theme_1"}e.classList.add(s)}));const i=o.slides.length,r=300*i;gsap.registerPlugin(ScrollTrigger),ScrollTrigger.create({trigger:".production-slider",start:"top top",end:`+=${r}`,pin:!0,onUpdate:e=>{const t=Math.floor(e.progress*i);o.slideTo(t)}})}function initSiteHeader(e,t,o){const s=e.querySelector(".site-header__burger"),i=e.querySelector(".site-header__site-navigation");t(s,(()=>{e.classList.toggle("site-header--expanded"),togglePageScroll()})),o(i);let r=0;window.addEventListener("scroll",(()=>{const t=e.offsetHeight;window.scrollY>0&&e.classList.add("site-header--sticked"),window.scrollY>r&&window.scrollY>t?e.classList.add("site-header--hidden"):(e.classList.remove("site-header--hidden"),0===window.scrollY&&e.classList.remove("site-header--sticked")),r=window.scrollY}))}function toggleSiteNavigationSubMenu(e,t){e.classList.toggle(t),e.ariaExpanded=e.classList.contains(t)}function initSiteNavigation(e){e.addEventListener("click",(e=>{const t=window.matchMedia("(min-width: 1260px)"),o=e.target.closest(".site-navigation__sub-menu-button");o&&!t.matches&&toggleSiteNavigationSubMenu(o,"site-navigation__sub-menu-button--active")}))}const siteHeaderElement=document.querySelector(".site-header");initSiteHeader(siteHeaderElement,initBurger,initSiteNavigation);const showAlert=initAlertCreator(openModal);document.querySelectorAll(".selection-list--news").forEach(initNewsSelectionList),document.querySelectorAll(".section__contacts-map").forEach(initMap),document.querySelectorAll(".certificates-list").forEach(initCertificatesList),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".features-list").forEach(initFeaturesList),document.querySelectorAll(".features-slider").forEach(initFeaturesSlider),document.querySelectorAll('[data-modal="request"]').forEach((e=>{initModalForm({modalElement:e,openModal:openModal,sendData:sendData})})),document.querySelectorAll("form[data-name]").forEach((e=>{initForm({formElement:e,sendData:sendData,showAlert:showAlert})})),document.querySelectorAll(".production-slider").forEach(initProductionSlider),document.querySelectorAll(".photo-slider").forEach(initPhotoSlider),document.querySelectorAll(".adaptive-table").forEach(initAdaptiveTable),document.querySelectorAll('input[type="tel"]').forEach(initTelField);