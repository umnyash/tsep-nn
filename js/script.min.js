"use strict";const LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)";function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function debounce(e){var t=this;let o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];clearTimeout(o),o=setTimeout((()=>e.apply(t,n)),i)}}function togglePageScroll(){const e=document.body.clientWidth;if(document.body.classList.toggle("scroll-lock"),document.body.classList.contains("scroll-lock")){if(document.body.clientWidth===e)return;document.body.style.paddingRight=document.body.clientWidth-e+"px"}else document.body.style.paddingRight="0"}function lockPageScroll(){const e=document.body.clientWidth;document.body.classList.add("scroll-lock"),document.body.clientWidth!==e&&(document.body.style.paddingRight=document.body.clientWidth-e+"px")}function unlockPageScroll(){document.body.classList.remove("scroll-lock"),document.body.style.paddingRight="0"}function initAdaptiveTable(e){const t=e.querySelectorAll("thead > tr > td");e.querySelectorAll("tbody > tr").forEach((e=>{e.querySelectorAll("td").forEach(((e,o)=>{const i=t[o].textContent;e.dataset.label=i}))})),e.addEventListener("click",(e=>{let{target:t}=e;const o=t.closest("tbody tr");o?.classList.toggle("open")}))}function initAlertCreator(e){return t=>{const o=createElementByString(`\n      <dialog class="modal modal--position_center modal--with_alert">\n        <div class="modal__inner">\n          <button class="modal__close-button" type="button">\n            <span class="visually-hidden">Закрыть</span>\n          </button>\n          <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n            <h2 class="alert__heading heading">${t.heading}</h2>\n            ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n            <button class="alert__button button button--primary" type="button">${t.buttonText||"Закрыть"}</button>\n          </section>\n        </div>\n      </dialog>\n    `);document.body.append(o),e(o)}}async function sendData(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};try{const i=await fetch(e,{method:"POST",body:t});if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);o(await i.json())}catch(e){i()}finally{r()}}function initBurger(e,t){const o="burger--open";e.addEventListener("click",(i=>{i.preventDefault(),e.classList.toggle(o),e.ariaExpanded=e.classList.contains(o),t()}))}function initCertificatesList(e){const t=e.querySelector(".certificates-list__item"),o=e.querySelector(".certificates-list__button"),i=()=>{e.classList.remove("certificates-list--short"),setTimeout((()=>{e.offsetHeight>t.offsetHeight&&e.classList.add("certificates-list--short")}),0)};i(),window.addEventListener("resize",debounce(i)),o.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("certificates-list--short")}))}function initFeaturesList(e){const t=Array.from(e.querySelectorAll(".features-list__item")),o=()=>{e.style.setProperty("--item-min-height",0),setTimeout((()=>{const o=t.map((e=>e.offsetHeight)),i=`${Math.max(...o)}px`;e.style.setProperty("--item-min-height",i)}),0)};o(),window.addEventListener("resize",debounce(o))}function initFeaturesSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1260:{slidesPerView:3},1580:{slidesPerView:3,spaceBetween:20}}})}const initFolds=e=>{e.addEventListener("click",(e=>{let{target:t}=e;const o=t.closest(".folds__button");if(!o)return;o.closest(".folds__item").classList.toggle("folds__item--open"),o.ariaExpanded="true"===o.ariaExpanded?"false":"true"}))},formAlerts={request:{success:{heading:"Заявка отправлена",text:"Скоро с Вами свяжется наш менеджер для уточнения деталей заказа и доставки"},error:{status:"error",heading:"Ошибка",text:"Ошибки – это доказательство того, что ты пытаешься."}}};function initForm(e){let{formElement:t,sendData:o,showAlert:i}=e;const r="button--pending",n=t.dataset.name,s=t.querySelector(".form__submit-button"),a=t.querySelector(".form__error-message-wrapper"),l=t.getAttribute("action"),c=t.querySelector(".form__item--name .text-field__control"),d=t.querySelector(".form__item--phone .text-field__control"),u=t.querySelector(".form__item--organization .text-field__control"),m=t.querySelector(".form__item--message .text-area__control");c&&(c.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",c.dataset.pristineRequiredMessage="Заполните это поле.",c.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),d&&(d.dataset.pristineRequiredMessage="Заполните это поле."),u&&(u.dataset.pristineRequiredMessage="Заполните это поле."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле.");const p=new Pristine(t,{classTo:"form__item",errorClass:"invalid",errorTextParent:"form__item",errorTextTag:"p",errorTextClass:"prompt-text"});t.addEventListener("submit",(e=>{e.preventDefault();p.validate()?(a.innerHTML="",s.disabled=!0,s.classList.add(r),o(l,new FormData(e.target),(e=>{i(formAlerts[n].success),t.reset()}),(()=>{a.insertAdjacentHTML("beforeend","<strong class='form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{a.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{s.disabled=!1,s.classList.remove(r)}))):(t.classList.remove("shake"),setTimeout((()=>t.classList.add("shake")),50))}))}async function initMap(e){const t=[43.895817,56.227675],o=e.querySelector(".map__inner");await ymaps3.ready;const{YMap:i,YMapDefaultSchemeLayer:r,YMapMarker:n,YMapDefaultFeaturesLayer:s}=ymaps3,a=new i(o,{location:{center:t,zoom:12}});a.addChild(new r),a.addChild(new s);const l=new n({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0));a.addChild(l)}function initModalForm(e){let{modalElement:t,openModal:o,sendData:i}=e;const r="button--pending",n=t.dataset.modal,s=t.querySelector(".modal__inner"),a=s.querySelector(".modal-form-section"),l=a.querySelector(".modal-form"),c=l.querySelector(".modal-form__submit-button"),d=l.querySelector(".modal-form__error-message-wrapper"),u=l.getAttribute("action"),m=l.querySelector(".modal-form__item--name .text-field__control"),p=l.querySelector(".modal-form__item--phone .text-field__control"),f=l.querySelector(".modal-form__item--organization .text-field__control"),g=l.querySelector(".modal-form__item--message .text-area__control");m&&(m.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",m.dataset.pristineRequiredMessage="Заполните это поле.",m.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),p&&(p.dataset.pristineRequiredMessage="Заполните это поле."),f&&(f.dataset.pristineRequiredMessage="Заполните это поле."),g&&(g.dataset.pristineRequiredMessage="Заполните это поле.");const _=new Pristine(l,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});l.addEventListener("submit",(e=>{e.preventDefault();_.validate()?(d.innerHTML="",c.disabled=!0,c.classList.add(r),i(u,new FormData(e.target),(e=>{a.classList.add("modal-form-section--response"),l.reset()}),(()=>{d.insertAdjacentHTML("beforeend","<strong class='modal-form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{d.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{c.disabled=!1,c.classList.remove(r)}))):(l.classList.remove("shake"),setTimeout((()=>l.classList.add("shake")),50))})),document.querySelectorAll(`[data-modal-opener="${n}"]`).forEach((e=>{const i=e.closest(".options");if(i){const e=Array.from(i.querySelectorAll(".options__variants-link--active")).map((e=>`\n        <input type="hidden" name=${e.dataset.name} value=${e.dataset.value}>\n      `)).join("");l.insertAdjacentHTML("beforeend",e)}e.addEventListener("click",(e=>{e.preventDefault(),d.innerHTML="",_.reset(),l.reset(),l.classList.remove("shake"),s.addEventListener("transitionend",(()=>{t.querySelector("input").focus()}),{once:!0}),a.classList.remove("modal-form-section--response"),o(t)}))}))}function initModalPhoto(e){let{modalElement:t,openModal:o}=e;const i=t.querySelector(".photo__image");document.querySelectorAll('[data-modal-opener="photo"]').forEach((e=>{e.addEventListener("click",(e=>{const r=e.target.closest("a");r&&(e.preventDefault(),i.src="",setTimeout((()=>{i.src=r.getAttribute("href"),o(t)}),0))}))}))}const MODAL_CLOSING_ANIMATION_DURATION=450;function onModalClose(e){const t=e.currentTarget;t.removeEventListener("close",onModalClose),t.removeEventListener("click",onModalClick),setTimeout((()=>{unlockPageScroll()}),MODAL_CLOSING_ANIMATION_DURATION),t.classList.contains("modal--with_alert")&&setTimeout((()=>{t.remove()}),MODAL_CLOSING_ANIMATION_DURATION)}function onModalClick(e){const t=e.currentTarget;(e.target.classList.contains("modal__close-button")||e.target.classList.contains("alert__button")||t.classList.contains("modal--with_photo")&&e.target===t)&&t.close()}function openModal(e){lockPageScroll(),e.addEventListener("close",onModalClose),e.addEventListener("click",onModalClick),e.showModal()}function initPartialList(e){e.querySelector(".partial-list__button").addEventListener("click",(t=>{t.preventDefault(),e.classList.add("partial-list--expand")}))}function initPhotoSlider(e){const t=e.querySelector(".photo-slider__main-slider"),o=t.querySelector(".photo-slider__main-slider-arrow--prev"),i=t.querySelector(".photo-slider__main-slider-arrow--next"),r=e.querySelector(".photo-slider__thumbnails-slider"),n=new Swiper(r,{spaceBetween:10,watchSlidesProgress:!0,slidesPerView:3,spaceBetween:10,breakpoints:{1580:{spaceBetween:20}}});new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},navigation:{prevEl:o,nextEl:i,disabledClass:"photo-slider__main-slider-arrow--disabled"},thumbs:{swiper:n,slideThumbActiveClass:"photo-slider__thumbnails-slider-item--active"}})}function initProductionSlider(e){const t=e.querySelector(".production-slider__slider"),o=new Swiper(t,{slidesPerView:1,pagination:{el:".production-slider__pagination",bulletClass:"production-slider__pagination-item",bulletActiveClass:"production-slider__pagination-item--active"},allowTouchMove:!1});let i="null";o.on("slideChange",(()=>{e.classList.remove(i);const t=o.realIndex+1;switch(!0){case t%4==3:i="production-slider--theme_3";break;case t%2==0:i="production-slider--theme_2";break;default:i="production-slider--theme_1"}e.classList.add(i)}));const r=o.slides.length,n=320*r;gsap.registerPlugin(ScrollTrigger),ScrollTrigger.create({trigger:".production-slider",start:"top top",end:`+=${n}`,pin:!0,onUpdate:e=>{const t=Math.floor(e.progress*r);o.slideTo(t)}})}function initSiteHeader(e,t,o){const i=e.querySelector(".site-header__burger"),r=e.querySelector(".site-header__site-navigation");t(i,(()=>{e.classList.toggle("site-header--expanded"),togglePageScroll()})),o(r);let n=0;const s=()=>{const t=e.offsetHeight;window.scrollY>0&&e.classList.add("site-header--sticked"),window.scrollY>n&&window.scrollY>t?e.classList.add("site-header--hidden"):(e.classList.remove("site-header--hidden"),0===window.scrollY&&e.classList.remove("site-header--sticked")),n=window.scrollY};window.addEventListener("scroll",s),s()}function toggleSiteNavigationSubMenu(e,t){e.classList.toggle(t),e.ariaExpanded=e.classList.contains(t)}function initSiteNavigation(e){e.addEventListener("click",(e=>{const t=window.matchMedia("(min-width: 1260px)"),o=e.target.closest(".site-navigation__sub-menu-button");o&&!t.matches&&toggleSiteNavigationSubMenu(o,"site-navigation__sub-menu-button--active")}))}function initTelField(e){function t(e){return e.value.replace(/\D/g,"")}e.addEventListener("input",(function(e){const o=e.target;let i=t(o),r="";const n=o.selectionStart;if(!i)return void(o.value="");if(o.value.length!==n)return void(e.data&&/\D/g.test(e.data)&&(o.value=i));if(!["7","8","9"].includes(i[0]))return void(o.value=`+${i}`.substring(0,16));"9"===i[0]&&(i=`7${i}`),r=`${"8"===i[0]?"8":"+7"} `,i.length>1&&(r+=`(${i.substring(1,4)}`),i.length>=5&&(r+=`) ${i.substring(4,7)}`),i.length>=8&&(r+=`-${i.substring(7,9)}`),i.length>=10&&(r+=`-${i.substring(9,11)}`),o.value=r})),e.addEventListener("keydown",(function(e){const o=e.target;"Backspace"===e.code&&1===t(o).length&&(o.value="")})),e.addEventListener("paste",(function(e){const o=e.clipboardData||window.clipboardData,i=e.target,r=t(i);if(o){const e=o.getData("Text");/\D/g.test(e)&&(i.value=r)}}))}const siteHeaderElement=document.querySelector(".site-header");initSiteHeader(siteHeaderElement,initBurger,initSiteNavigation);const showAlert=initAlertCreator(openModal);document.querySelectorAll(".section__contacts-map").forEach(initMap),document.querySelectorAll(".certificates-list").forEach(initCertificatesList),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".features-list").forEach(initFeaturesList),document.querySelectorAll(".features-slider").forEach(initFeaturesSlider),document.querySelectorAll('[data-modal="request"]').forEach((e=>{initModalForm({modalElement:e,openModal:openModal,sendData:sendData})})),document.querySelectorAll("form[data-name]").forEach((e=>{initForm({formElement:e,sendData:sendData,showAlert:showAlert})})),document.querySelectorAll(".production-slider").forEach(initProductionSlider),document.querySelectorAll(".partial-list").forEach(initPartialList),document.querySelectorAll(".photo-slider").forEach(initPhotoSlider),document.querySelectorAll(".adaptive-table-wrapper").forEach(initAdaptiveTable),document.querySelectorAll('input[type="tel"]').forEach(initTelField),document.querySelectorAll('[data-modal="photo"]').forEach((e=>{initModalPhoto({modalElement:e,openModal:openModal})}));