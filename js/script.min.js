"use strict";const LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)";function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function debounce(e){var t=this;let o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];clearTimeout(o),o=setTimeout((()=>e.apply(t,s)),r)}}function togglePageScroll(){const e=document.body.clientWidth;if(document.body.classList.toggle("scroll-lock"),document.body.classList.contains("scroll-lock")){if(document.body.clientWidth===e)return;document.body.style.paddingRight=document.body.clientWidth-e+"px"}else document.body.style.paddingRight="0"}function lockPageScroll(){const e=document.body.clientWidth;document.body.classList.add("scroll-lock"),document.body.clientWidth!==e&&(document.body.style.paddingRight=document.body.clientWidth-e+"px")}function unlockPageScroll(){document.body.classList.remove("scroll-lock"),document.body.style.paddingRight="0"}function initAdaptiveTable(e){const t=e.querySelectorAll("thead > tr > td");e.querySelectorAll("tbody > tr").forEach((e=>{e.querySelectorAll("td").forEach(((e,o)=>{const r=t[o].textContent;e.dataset.label=r}))})),e.addEventListener("click",(e=>{let{target:t}=e;const o=t.closest("tbody tr");o?.classList.toggle("open")}))}function initAlertCreator(e){return t=>{const o=createElementByString(`\n      <dialog class="modal modal--position_center modal--with_alert">\n        <div class="modal__inner">\n          <button class="modal__close-button" type="button">\n            <span class="visually-hidden">Закрыть</span>\n          </button>\n          <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n            <h2 class="alert__heading heading">${t.heading}</h2>\n            ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n            <button class="alert__button button button--primary" type="button">${t.buttonText||"Закрыть"}</button>\n          </section>\n        </div>\n      </dialog>\n    `);document.body.append(o),e(o)}}async function sendData(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};try{const r=await fetch(e,{method:"POST",body:t});if(!r.ok)throw new Error(`${r.status} – ${r.statusText}`);o(await r.json())}catch(e){r()}finally{i()}}function initBurger(e,t){const o="burger--open";e.addEventListener("click",(r=>{r.preventDefault(),e.classList.toggle(o),e.ariaExpanded=e.classList.contains(o),t()}))}function initCertificatesList(e){const t=e.querySelector(".certificates-list__item"),o=e.querySelector(".certificates-list__button"),r=()=>{e.classList.remove("certificates-list--short"),setTimeout((()=>{e.offsetHeight>t.offsetHeight&&e.classList.add("certificates-list--short")}),0)};r(),window.addEventListener("resize",debounce(r)),o.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("certificates-list--short")}))}function initFeaturesList(e){const t=Array.from(e.querySelectorAll(".features-list__item")),o=()=>{e.style.setProperty("--item-min-height",0),setTimeout((()=>{const o=t.map((e=>e.offsetHeight)),r=`${Math.max(...o)}px`;e.style.setProperty("--item-min-height",r)}),0)};o(),window.addEventListener("resize",debounce(o))}function initFeaturesSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1260:{slidesPerView:3},1580:{slidesPerView:3,spaceBetween:20}}})}const initFolds=e=>{e.addEventListener("click",(e=>{let{target:t}=e;const o=t.closest(".folds__button");if(!o)return;o.closest(".folds__item").classList.toggle("folds__item--open"),o.ariaExpanded="true"===o.ariaExpanded?"false":"true"}))},formAlerts={request:{success:{heading:"Заявка отправлена",text:"Скоро с Вами свяжется наш менеджер для уточнения деталей заказа и доставки"},error:{status:"error",heading:"Ошибка",text:"Ошибки – это доказательство того, что ты пытаешься."}}};function initForm(e){let{formElement:t,sendData:o,showAlert:r}=e;const i="button--pending",s=t.dataset.name,n=t.querySelector(".form__submit-button"),a=t.querySelector(".form__error-message-wrapper"),l=t.getAttribute("action"),c=t.querySelector(".form__item--name .text-field__control"),d=t.querySelector(".form__item--phone .text-field__control"),u=t.querySelector(".form__item--organization .text-field__control"),m=t.querySelector(".form__item--message .text-area__control");c&&(c.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",c.dataset.pristineRequiredMessage="Заполните это поле.",c.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),d&&(d.dataset.pristineRequiredMessage="Заполните это поле."),u&&(u.dataset.pristineRequiredMessage="Заполните это поле."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле.");const p=new Pristine(t,{classTo:"form__item",errorClass:"invalid",errorTextParent:"form__item",errorTextTag:"p",errorTextClass:"prompt-text"});t.addEventListener("submit",(e=>{e.preventDefault();p.validate()?(a.innerHTML="",n.disabled=!0,n.classList.add(i),o(l,new FormData(e.target),(e=>{r(formAlerts[s].success),t.reset()}),(()=>{a.insertAdjacentHTML("beforeend","<strong class='form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{a.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{n.disabled=!1,n.classList.remove(i)}))):(t.classList.remove("shake"),setTimeout((()=>t.classList.add("shake")),50))}))}async function initMap(e){const t=[43.895817,56.227675],o=e.querySelector(".map__inner");await ymaps3.ready;const{YMap:r,YMapDefaultSchemeLayer:i,YMapMarker:s,YMapDefaultFeaturesLayer:n}=ymaps3,a=new r(o,{location:{center:t,zoom:12}});a.addChild(new i),a.addChild(new n);const l=new s({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0));a.addChild(l)}function initModalForm(e){let{modalElement:t,openModal:o,sendData:r}=e;const i="button--pending",s=t.dataset.modal,n=t.querySelector(".modal__inner"),a=n.querySelector(".modal-form-section"),l=a.querySelector(".modal-form"),c=l.querySelector(".modal-form__submit-button"),d=l.querySelector(".modal-form__error-message-wrapper"),u=l.getAttribute("action"),m=l.querySelector(".modal-form__item--name .text-field__control"),p=l.querySelector(".modal-form__item--phone .text-field__control"),g=l.querySelector(".modal-form__item--organization .text-field__control"),f=l.querySelector(".modal-form__item--message .text-area__control");m&&(m.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",m.dataset.pristineRequiredMessage="Заполните это поле.",m.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),p&&(p.dataset.pristineRequiredMessage="Заполните это поле."),g&&(g.dataset.pristineRequiredMessage="Заполните это поле."),f&&(f.dataset.pristineRequiredMessage="Заполните это поле.");const _=new Pristine(l,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});l.addEventListener("submit",(e=>{e.preventDefault();_.validate()?(d.innerHTML="",c.disabled=!0,c.classList.add(i),r(u,new FormData(e.target),(e=>{a.classList.add("modal-form-section--response"),l.reset()}),(()=>{d.insertAdjacentHTML("beforeend","<strong class='modal-form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{d.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{c.disabled=!1,c.classList.remove(i)}))):(l.classList.remove("shake"),setTimeout((()=>l.classList.add("shake")),50))})),document.querySelectorAll(`[data-modal-opener="${s}"]`).forEach((e=>{const r=e.closest(".options");if(r){const e=Array.from(r.querySelectorAll(".options__variants-link--active")).map((e=>`\n        <input type="hidden" name=${e.dataset.name} value=${e.dataset.value}>\n      `)).join("");l.insertAdjacentHTML("beforeend",e)}e.addEventListener("click",(e=>{e.preventDefault(),d.innerHTML="",_.reset(),l.reset(),l.classList.remove("shake"),n.addEventListener("transitionend",(()=>{t.querySelector("input").focus()}),{once:!0}),a.classList.remove("modal-form-section--response"),o(t)}))}))}function initModalPhoto(e){let{modalElement:t,openModal:o}=e;const r=t.querySelector(".photo__image");document.querySelectorAll('[data-modal-opener="photo"]').forEach((e=>{e.addEventListener("click",(e=>{const i=e.target.closest("a");i&&(e.preventDefault(),r.src="",setTimeout((()=>{r.src=i.getAttribute("href"),o(t)}),0))}))}))}const MODAL_CLOSING_ANIMATION_DURATION=450;function onModalClose(e){const t=e.currentTarget;t.removeEventListener("close",onModalClose),t.removeEventListener("click",onModalClick),setTimeout((()=>{unlockPageScroll()}),MODAL_CLOSING_ANIMATION_DURATION),t.classList.contains("modal--with_alert")&&setTimeout((()=>{t.remove()}),MODAL_CLOSING_ANIMATION_DURATION)}function onModalClick(e){const t=e.currentTarget;(e.target.classList.contains("modal__close-button")||e.target.classList.contains("alert__button")||t.classList.contains("modal--with_photo")&&e.target===t)&&t.close()}function openModal(e){lockPageScroll(),e.addEventListener("close",onModalClose),e.addEventListener("click",onModalClick),e.showModal()}function initNewsSelectionList(e){const t=document.querySelector(".cursor-picture"),o=t.querySelector(".cursor-picture__image");e.querySelectorAll(".selection-list__item-link").forEach((e=>{e.addEventListener("mouseover",(e=>{let{target:r}=e;const i=r.parentElement.dataset.cursorImage;o.style.backgroundImage=`url("${i}")`,t.classList.remove("cursor-picture--hidden")})),e.addEventListener("mousemove",(e=>{t.style.top=`${e.pageY}px`,t.style.left=`${e.pageX}px`})),e.addEventListener("mouseout",(()=>{t.classList.add("cursor-picture--hidden")}))}))}function initPartialList(e){e.querySelector(".partial-list__button").addEventListener("click",(t=>{t.preventDefault(),e.classList.add("partial-list--expand")}))}function initPhotoSlider(e){const t=e.querySelector(".photo-slider__main-slider"),o=t.querySelector(".photo-slider__main-slider-arrow--prev"),r=t.querySelector(".photo-slider__main-slider-arrow--next"),i=e.querySelector(".photo-slider__thumbnails-slider"),s=new Swiper(i,{spaceBetween:10,watchSlidesProgress:!0,slidesPerView:3,spaceBetween:10,breakpoints:{1580:{spaceBetween:20}}});new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},navigation:{prevEl:o,nextEl:r,disabledClass:"photo-slider__main-slider-arrow--disabled"},thumbs:{swiper:s,slideThumbActiveClass:"photo-slider__thumbnails-slider-item--active"}})}function initProductionSlider(e){const t=e.querySelector(".production-slider__slider"),o=new Swiper(t,{slidesPerView:1,pagination:{el:".production-slider__pagination",bulletClass:"production-slider__pagination-item",bulletActiveClass:"production-slider__pagination-item--active"},allowTouchMove:!1});let r="null";o.on("slideChange",(()=>{e.classList.remove(r);const t=o.realIndex+1;switch(!0){case t%4==3:r="production-slider--theme_3";break;case t%2==0:r="production-slider--theme_2";break;default:r="production-slider--theme_1"}e.classList.add(r)}));const i=o.slides.length,s=320*i;gsap.registerPlugin(ScrollTrigger),ScrollTrigger.create({trigger:".production-slider",start:"top top",end:`+=${s}`,pin:!0,onUpdate:e=>{const t=Math.floor(e.progress*i);o.slideTo(t)}})}function initSiteHeader(e,t,o){const r=e.querySelector(".site-header__burger"),i=e.querySelector(".site-header__site-navigation");t(r,(()=>{e.classList.toggle("site-header--expanded"),togglePageScroll()})),o(i);let s=0;const n=()=>{const t=e.offsetHeight;window.scrollY>0&&e.classList.add("site-header--sticked"),window.scrollY>s&&window.scrollY>t?e.classList.add("site-header--hidden"):(e.classList.remove("site-header--hidden"),0===window.scrollY&&e.classList.remove("site-header--sticked")),s=window.scrollY};window.addEventListener("scroll",n),n()}function toggleSiteNavigationSubMenu(e,t){e.classList.toggle(t),e.ariaExpanded=e.classList.contains(t)}function initSiteNavigation(e){e.addEventListener("click",(e=>{const t=window.matchMedia("(min-width: 1260px)"),o=e.target.closest(".site-navigation__sub-menu-button");o&&!t.matches&&toggleSiteNavigationSubMenu(o,"site-navigation__sub-menu-button--active")}))}function initTelField(e){function t(e){return e.value.replace(/\D/g,"")}e.addEventListener("input",(function(e){const o=e.target;let r=t(o),i="";const s=o.selectionStart;if(!r)return void(o.value="");if(o.value.length!==s)return void(e.data&&/\D/g.test(e.data)&&(o.value=r));if(!["7","8","9"].includes(r[0]))return void(o.value=`+${r}`.substring(0,16));"9"===r[0]&&(r=`7${r}`),i=`${"8"===r[0]?"8":"+7"} `,r.length>1&&(i+=`(${r.substring(1,4)}`),r.length>=5&&(i+=`) ${r.substring(4,7)}`),r.length>=8&&(i+=`-${r.substring(7,9)}`),r.length>=10&&(i+=`-${r.substring(9,11)}`),o.value=i})),e.addEventListener("keydown",(function(e){const o=e.target;"Backspace"===e.code&&1===t(o).length&&(o.value="")})),e.addEventListener("paste",(function(e){const o=e.clipboardData||window.clipboardData,r=e.target,i=t(r);if(o){const e=o.getData("Text");/\D/g.test(e)&&(r.value=i)}}))}const siteHeaderElement=document.querySelector(".site-header");initSiteHeader(siteHeaderElement,initBurger,initSiteNavigation);const showAlert=initAlertCreator(openModal);document.querySelectorAll(".selection-list--news").forEach(initNewsSelectionList),document.querySelectorAll(".section__contacts-map").forEach(initMap),document.querySelectorAll(".certificates-list").forEach(initCertificatesList),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".features-list").forEach(initFeaturesList),document.querySelectorAll(".features-slider").forEach(initFeaturesSlider),document.querySelectorAll('[data-modal="request"]').forEach((e=>{initModalForm({modalElement:e,openModal:openModal,sendData:sendData})})),document.querySelectorAll("form[data-name]").forEach((e=>{initForm({formElement:e,sendData:sendData,showAlert:showAlert})})),document.querySelectorAll(".production-slider").forEach(initProductionSlider),document.querySelectorAll(".partial-list").forEach(initPartialList),document.querySelectorAll(".photo-slider").forEach(initPhotoSlider),document.querySelectorAll(".adaptive-table-wrapper").forEach(initAdaptiveTable),document.querySelectorAll('input[type="tel"]').forEach(initTelField),document.querySelectorAll('[data-modal="photo"]').forEach((e=>{initModalPhoto({modalElement:e,openModal:openModal})}));