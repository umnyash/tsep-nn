"use strict";const LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)";function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function debounce(e,t=500){let o;return(...s)=>{clearTimeout(o),o=setTimeout((()=>e.apply(this,s)),t)}}function togglePageScroll(){const e=document.body.clientWidth;if(document.body.classList.toggle("scroll-lock"),document.body.classList.contains("scroll-lock")){if(document.body.clientWidth===e)return;document.body.style.paddingRight=document.body.clientWidth-e+"px"}else document.body.style.paddingRight="0"}function initAlertCreator(e){return t=>{const o=createElementByString(`\n      <dialog class="modal modal--position_center modal--with_alert">\n        <div class="modal__inner">\n          <button class="modal__close-button" type="button">\n            <span class="visually-hidden">Закрыть</span>\n          </button>\n          <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n            <h2 class="alert__heading heading">${t.heading}</h2>\n            ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n            <button class="alert__button button button--primary" type="button">${t.buttonText||"Закрыть"}</button>\n          </section>\n        </div>\n      </dialog>\n    `);document.body.append(o),e(o)}}async function sendData(e,t,o=(()=>{}),s=(()=>{}),r=(()=>{})){try{const s=await fetch(e,{method:"POST",body:t});if(!s.ok)throw new Error(`${s.status} – ${s.statusText}`);o(await s.json())}catch(e){s()}finally{r()}}function initBurger(e,t){const o="burger--open";e.addEventListener("click",(s=>{s.preventDefault(),e.classList.toggle(o),e.ariaExpanded=e.classList.contains(o),t()}))}function initCertificatesList(e){const t=e.querySelector(".certificates-list__item"),o=e.querySelector(".certificates-list__button"),s=()=>{e.classList.remove("certificates-list--short"),setTimeout((()=>{e.offsetHeight>t.offsetHeight&&e.classList.add("certificates-list--short")}),0)};s(),window.addEventListener("resize",debounce(s)),o.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("certificates-list--short")}))}function initFeaturesList(e){const t=Array.from(e.querySelectorAll(".features-list__item")),o=()=>{e.style.setProperty("--item-min-height",0),setTimeout((()=>{const o=t.map((e=>e.offsetHeight)),s=`${Math.max(...o)}px`;e.style.setProperty("--item-min-height",s)}),0)};o(),window.addEventListener("resize",debounce(o))}function initFeaturesSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1260:{slidesPerView:3},1580:{slidesPerView:3,spaceBetween:20}}})}const initFolds=e=>{e.addEventListener("click",(({target:e})=>{const t=e.closest(".folds__button");if(!t)return;t.closest(".folds__item").classList.toggle("folds__item--open"),t.ariaExpanded="true"===t.ariaExpanded?"false":"true"}))},formAlerts={request:{success:{heading:"Заявка отправлена",text:"Скоро с Вами свяжется наш менеджер для уточнения деталей заказа и доставки"},error:{status:"error",heading:"Ошибка",text:"Ошибки – это доказательство того, что ты пытаешься."}}};function initForm({formElement:e,sendData:t,showAlert:o}){const s="button--pending",r=e.dataset.name,n=e.querySelector(".form__submit-button"),a=e.querySelector(".form__error-message-wrapper"),i=e.getAttribute("action"),l=e.querySelector(".form__item--name .text-field__control"),c=e.querySelector(".form__item--phone .text-field__control"),d=e.querySelector(".form__item--organization .text-field__control"),u=e.querySelector(".form__item--message .text-area__control");l&&(l.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),c&&(c.dataset.pristineRequiredMessage="Заполните это поле."),d&&(d.dataset.pristineRequiredMessage="Заполните это поле."),u&&(u.dataset.pristineRequiredMessage="Заполните это поле.");const m=new Pristine(e,{classTo:"form__item",errorClass:"invalid",errorTextParent:"form__item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("submit",(l=>{l.preventDefault();m.validate()?(a.innerHTML="",n.disabled=!0,n.classList.add(s),t(i,new FormData(l.target),(t=>{o(formAlerts[r].success),e.reset()}),(()=>{a.insertAdjacentHTML("beforeend","<strong class='form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{a.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{n.disabled=!1,n.classList.remove(s)}))):(e.classList.remove("shake"),setTimeout((()=>e.classList.add("shake")),50))}))}async function initMap(e){const t=[43.895817,56.227675],o=e.querySelector(".map__inner");await ymaps3.ready;const{YMap:s,YMapDefaultSchemeLayer:r,YMapMarker:n,YMapDefaultFeaturesLayer:a}=ymaps3,i=new s(o,{location:{center:t,zoom:12}});i.addChild(new r),i.addChild(new a);const l=new n({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0));i.addChild(l)}function initModalForm({modalElement:e,openModal:t,sendData:o}){const s="button--pending",r=e.dataset.modal,n=e.querySelector(".modal__inner"),a=n.querySelector(".modal-form-section"),i=a.querySelector(".modal-form"),l=i.querySelector(".modal-form__submit-button"),c=i.querySelector(".modal-form__error-message-wrapper"),d=i.getAttribute("action"),u=i.querySelector(".modal-form__item--name .text-field__control"),m=i.querySelector(".modal-form__item--phone .text-field__control"),_=i.querySelector(".modal-form__item--organization .text-field__control"),f=i.querySelector(".modal-form__item--message .text-area__control");u&&(u.dataset.pristinePattern="/^[a-zа-яЁё -]+$/i",u.dataset.pristineRequiredMessage="Заполните это поле.",u.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле."),_&&(_.dataset.pristineRequiredMessage="Заполните это поле."),f&&(f.dataset.pristineRequiredMessage="Заполните это поле.");const p=new Pristine(i,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});i.addEventListener("submit",(e=>{e.preventDefault();p.validate()?(c.innerHTML="",l.disabled=!0,l.classList.add(s),o(d,new FormData(e.target),(e=>{a.classList.add("modal-form-section--response"),i.reset()}),(()=>{c.insertAdjacentHTML("beforeend","<strong class='modal-form__error-message shake'>Ошибка отправки данных. Проверьте подключение к интернету и попробуйте снова.</strong>"),setTimeout((()=>{c.scrollIntoView({behavior:"smooth"})}),100)}),(()=>{l.disabled=!1,l.classList.remove(s)}))):(i.classList.remove("shake"),setTimeout((()=>i.classList.add("shake")),50))})),document.querySelectorAll(`[data-modal-opener="${r}"]`).forEach((o=>{o.addEventListener("click",(o=>{o.preventDefault(),c.innerHTML="",p.reset(),i.reset(),i.classList.remove("shake"),n.addEventListener("transitionend",(()=>{e.querySelector("input").focus()}),{once:!0}),a.classList.remove("modal-form-section--response"),t(e)}))}))}const openedModals=[];function openModal(e){togglePageScroll(),e.showModal(),openedModals.push(e),document.addEventListener("click",onModalClick),e.addEventListener("close",onModalClose)}function closeModal(e){e.close(),setTimeout((()=>{e.removeEventListener("close",onModalClose)}),0)}function onModalClose(e){const t=openedModals.pop();if(t.classList.contains("modal--with_alert")&&t.addEventListener("transitionend",(e=>{"transform"===e.propertyName&&t.remove()}),{once:!0}),!openedModals.length){e.target.querySelector(".modal__inner").addEventListener("transitionend",(({target:e})=>{(e.classList.contains("modal")||e.classList.contains("modal__inner"))&&togglePageScroll()}),{once:!0}),document.removeEventListener("click",onModalClick)}}function onModalClick({target:e}){(e.classList.contains("modal__close-button")||e.classList.contains("alert__button"))&&closeModal(openedModals.at(-1))}function initNewsSelectionList(e){const t=document.querySelector(".cursor-picture"),o=t.querySelector(".cursor-picture__image");e.querySelectorAll(".selection-list__item-link").forEach((e=>{e.addEventListener("mouseover",(({target:e})=>{const s=e.parentElement.dataset.cursorImage;o.style.backgroundImage=`url("${s}")`,t.classList.remove("cursor-picture--hidden")})),e.addEventListener("mousemove",(e=>{t.style.top=`${e.pageY}px`,t.style.left=`${e.pageX}px`})),e.addEventListener("mouseout",(()=>{t.classList.add("cursor-picture--hidden")}))}))}function initSiteHeader(e,t,o){const s=e.querySelector(".site-header__burger"),r=e.querySelector(".site-header__site-navigation");t(s,(()=>{e.classList.toggle("site-header--expanded"),togglePageScroll()})),o(r)}function toggleSiteNavigationSubMenu(e,t){e.classList.toggle(t),e.ariaExpanded=e.classList.contains(t)}function initSiteNavigation(e){e.addEventListener("click",(e=>{const t=window.matchMedia("(min-width: 1260px)"),o=e.target.closest(".site-navigation__sub-menu-button");o&&!t.matches&&toggleSiteNavigationSubMenu(o,"site-navigation__sub-menu-button--active")}))}const siteHeaderElement=document.querySelector(".site-header");initSiteHeader(siteHeaderElement,initBurger,initSiteNavigation);const showAlert=initAlertCreator(openModal);document.querySelectorAll(".selection-list--news").forEach(initNewsSelectionList),document.querySelectorAll(".section__contacts-map").forEach(initMap),document.querySelectorAll(".certificates-list").forEach(initCertificatesList),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".features-list").forEach(initFeaturesList),document.querySelectorAll(".features-slider").forEach(initFeaturesSlider),document.querySelectorAll('[data-modal="request"]').forEach((e=>{initModalForm({modalElement:e,openModal:openModal,sendData:sendData})})),document.querySelectorAll("form[data-name]").forEach((e=>{initForm({formElement:e,sendData:sendData,showAlert:showAlert})}));